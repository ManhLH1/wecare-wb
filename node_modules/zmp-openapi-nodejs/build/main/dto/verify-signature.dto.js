"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.VerifySignature = void 0;
const crypto_1 = __importDefault(require("crypto"));
exports.VerifySignature = {
    generateSignature(data, apiKey) {
        try {
            if (!data || typeof data != 'object') {
                throw 'Data must be an object';
            }
            if (data['timestamp'] < 0) {
                throw 'Timestamp invalid';
            }
            const keys = Object.keys(data).sort();
            let content = '';
            for (let k of keys) {
                let value = data[k];
                if (typeof value == 'object') {
                    value = JSON.stringify(value);
                }
                content += value;
            }
            const signature = crypto_1.default
                .createHash('sha256')
                .update(`${content}${apiKey}`)
                .digest('hex');
            return signature;
        }
        catch (e) {
            const error = new Error(e);
            error.name = 'GenerateSignature-Exception';
            throw error;
        }
    },
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmVyaWZ5LXNpZ25hdHVyZS5kdG8uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvZHRvL3ZlcmlmeS1zaWduYXR1cmUuZHRvLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLG9EQUE0QjtBQUVmLFFBQUEsZUFBZSxHQUFHO0lBQzdCLGlCQUFpQixDQUFDLElBQWEsRUFBRSxNQUFjO1FBQzdDLElBQUk7WUFDRixJQUFJLENBQUMsSUFBSSxJQUFJLE9BQU8sSUFBSSxJQUFJLFFBQVEsRUFBRTtnQkFDcEMsTUFBTSx3QkFBd0IsQ0FBQzthQUNoQztZQUNELElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsRUFBRTtnQkFDekIsTUFBTSxtQkFBbUIsQ0FBQzthQUMzQjtZQUNELE1BQU0sSUFBSSxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUM7WUFDdEMsSUFBSSxPQUFPLEdBQUcsRUFBRSxDQUFDO1lBQ2pCLEtBQUssSUFBSSxDQUFDLElBQUksSUFBSSxFQUFFO2dCQUNsQixJQUFJLEtBQUssR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQ3BCLElBQUksT0FBTyxLQUFLLElBQUksUUFBUSxFQUFFO29CQUM1QixLQUFLLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQztpQkFDL0I7Z0JBQ0QsT0FBTyxJQUFJLEtBQUssQ0FBQzthQUNsQjtZQUNELE1BQU0sU0FBUyxHQUFHLGdCQUFNO2lCQUNyQixVQUFVLENBQUMsUUFBUSxDQUFDO2lCQUNwQixNQUFNLENBQUMsR0FBRyxPQUFPLEdBQUcsTUFBTSxFQUFFLENBQUM7aUJBQzdCLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUNqQixPQUFPLFNBQVMsQ0FBQztTQUNsQjtRQUFDLE9BQU8sQ0FBQyxFQUFFO1lBQ1YsTUFBTSxLQUFLLEdBQUcsSUFBSSxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDM0IsS0FBSyxDQUFDLElBQUksR0FBRyw2QkFBNkIsQ0FBQztZQUMzQyxNQUFNLEtBQUssQ0FBQztTQUNiO0lBQ0gsQ0FBQztDQUNGLENBQUMifQ==