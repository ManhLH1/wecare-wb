import crypto from 'crypto';
export const VerifySignature = {
    generateSignature(data, apiKey) {
        try {
            if (!data || typeof data != 'object') {
                throw 'Data must be an object';
            }
            if (data['timestamp'] < 0) {
                throw 'Timestamp invalid';
            }
            const keys = Object.keys(data).sort();
            let content = '';
            for (let k of keys) {
                let value = data[k];
                if (typeof value == 'object') {
                    value = JSON.stringify(value);
                }
                content += value;
            }
            const signature = crypto
                .createHash('sha256')
                .update(`${content}${apiKey}`)
                .digest('hex');
            return signature;
        }
        catch (e) {
            const error = new Error(e);
            error.name = 'GenerateSignature-Exception';
            throw error;
        }
    },
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmVyaWZ5LXNpZ25hdHVyZS5kdG8uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvZHRvL3ZlcmlmeS1zaWduYXR1cmUuZHRvLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sTUFBTSxNQUFNLFFBQVEsQ0FBQztBQUU1QixNQUFNLENBQUMsTUFBTSxlQUFlLEdBQUc7SUFDN0IsaUJBQWlCLENBQUMsSUFBYSxFQUFFLE1BQWM7UUFDN0MsSUFBSTtZQUNGLElBQUksQ0FBQyxJQUFJLElBQUksT0FBTyxJQUFJLElBQUksUUFBUSxFQUFFO2dCQUNwQyxNQUFNLHdCQUF3QixDQUFDO2FBQ2hDO1lBQ0QsSUFBSSxJQUFJLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxFQUFFO2dCQUN6QixNQUFNLG1CQUFtQixDQUFDO2FBQzNCO1lBQ0QsTUFBTSxJQUFJLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztZQUN0QyxJQUFJLE9BQU8sR0FBRyxFQUFFLENBQUM7WUFDakIsS0FBSyxJQUFJLENBQUMsSUFBSSxJQUFJLEVBQUU7Z0JBQ2xCLElBQUksS0FBSyxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDcEIsSUFBSSxPQUFPLEtBQUssSUFBSSxRQUFRLEVBQUU7b0JBQzVCLEtBQUssR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDO2lCQUMvQjtnQkFDRCxPQUFPLElBQUksS0FBSyxDQUFDO2FBQ2xCO1lBQ0QsTUFBTSxTQUFTLEdBQUcsTUFBTTtpQkFDckIsVUFBVSxDQUFDLFFBQVEsQ0FBQztpQkFDcEIsTUFBTSxDQUFDLEdBQUcsT0FBTyxHQUFHLE1BQU0sRUFBRSxDQUFDO2lCQUM3QixNQUFNLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDakIsT0FBTyxTQUFTLENBQUM7U0FDbEI7UUFBQyxPQUFPLENBQUMsRUFBRTtZQUNWLE1BQU0sS0FBSyxHQUFHLElBQUksS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQzNCLEtBQUssQ0FBQyxJQUFJLEdBQUcsNkJBQTZCLENBQUM7WUFDM0MsTUFBTSxLQUFLLENBQUM7U0FDYjtJQUNILENBQUM7Q0FDRixDQUFDIn0=